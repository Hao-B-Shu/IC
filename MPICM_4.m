r=2;
n=2*r;
E=eye(n);
P0=eye(n);

P1=zeros(n);
P1(:,1)=E(:,1)+E(:,2);
P1(:,2)=E(:,3)+E(:,4);
P1(:,3)=E(:,1)-E(:,2)+E(:,3)-E(:,4);
P1(:,4)=E(:,1)-E(:,2)-E(:,3)+E(:,4);

P2=zeros(n);
P2(:,1)=E(:,1)+E(:,3);
P2(:,2)=E(:,2)+E(:,4);
P2(:,3)=E(:,1)-E(:,3)+i*E(:,2)-i*E(:,4);
P2(:,4)=E(:,1)-E(:,3)-i*E(:,2)+i*E(:,4);

P3=zeros(n);
P3(:,1)=E(:,1)+i*E(:,2);
P3(:,2)=E(:,3)+i*E(:,4);
P3(:,3)=E(:,1)-i*E(:,2)+i*E(:,3)+E(:,4);
P3(:,4)=E(:,1)-i*E(:,2)-i*E(:,3)-E(:,4);

P4=zeros(n);
P4(:,1)=E(:,1)+i*E(:,3);
P4(:,2)=E(:,2)+i*E(:,4);
P4(:,3)=E(:,1)-i*E(:,3)+E(:,2)-i*E(:,4);
P4(:,4)=E(:,1)-i*E(:,3)-E(:,2)+i*E(:,4);

P=cell(1,n+1);
P{1,1}=P0;
P{1,2}=P1;
P{1,3}=P2;
P{1,4}=P3;
P{1,5}=P4;

Q=cell(1,n+1);
for l=1:n+1
    for k=1:n
        Q{1,l}(:,k)=reshape(P{1,l}(:,k)*P{1,l}(:,k)'/(norm(P{1,l}(:,k))^2)-(1/n)*E,n*n,1);
    end
    Q{1,l}=orth(Q{1,l});
end

H=[];
for l=1:n+1
    H=[H,Q{1,l}];
end

[QH,RH]=qr(H);
H=[H,QH(:,n^2)];

d=abs(det(H))
